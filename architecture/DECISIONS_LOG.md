# Decisions Log

Record all structural and architectural decisions.

| Date | Decision ID | Area | Decision | Rationale | Impact | Owner | Status |
|---|---|---|---|---|---|---|---|
| 2026-02-20 | DEC-0001 | Repo Structure | Initialized blueprint folders for architecture/spec/design/ops. | Create persistent source of truth before app implementation. | Enables consistent agent and team onboarding. | Jon | Accepted |
| 2026-02-20 | DEC-0002 | App UI | Implemented KPI Dashboard (My Qualifiers) from Figma node 173-4988. New screen: `app/screens/KPIDashboardScreen.tsx`; HomeScreen renders it with sign-out in header. | Align app with design source (Figma); single dashboard screen as first implementation. | Home post-login shows dashboard; design index and decisions log updated. | — | Accepted |
| 2026-02-20 | DEC-0003 | Design Integration | Standardized Figma ingestion and implementation mapping using `design/figma/exports/*` plus `docs/spec/appendix/FIGMA_BUILD_MAPPING.md`. | Make external design assets traceable and implementation-ready without relying on live Figma access during coding. | Adds stable export structure, canonical flow inventory, and screen-to-code mapping used for build sequencing. | Jon | Accepted |
| 2026-02-20 | DEC-0004 | API Boundary | Added Sprint-1 baseline endpoints `POST /kpi-logs` and `GET /dashboard` in backend with explicit non-negotiable enforcement rules. | Start KPI-core build with server-enforced separation of projection vs actuals and typed KPI behavior. | Establishes initial KPI ingestion/dashboard contract and traceable backend surface for upcoming schema and test hardening. | Codex | Accepted |
| 2026-02-20 | DEC-0005 | Data Schema | Added Sprint-1 core SQL migration `backend/sql/001_sprint1_kpi_core.sql` creating `users`, `kpis`, `kpi_logs`, and `pipeline_anchor_status` with KPI seed data. | Provide durable schema foundation required by in-scope Sprint-1 endpoints and non-negotiable constraints. | Backend API now has concrete table contracts for KPI logging, anchor tracking, and dashboard aggregation. | Codex | Accepted |
| 2026-02-20 | DEC-0006 | Data Schema | Set non-zero defaults for user financial inputs via `backend/sql/002_default_financial_inputs.sql`: `commission_rate=0.025`, `average_price_point=300000`, with backfill for null/zero rows. | Ensure PC projection math has sensible baseline values without requiring immediate onboarding input completion. | New user profiles now default to requested financial baseline; existing zero/null rows are normalized. | Codex | Accepted |
| 2026-02-20 | DEC-0007 | API/Data Integrity | Added KPI log idempotency support using optional `idempotency_key` and unique user-key constraint (`backend/sql/003_kpi_logs_idempotency.sql`). | Support offline retry safety and prevent duplicate writes while preserving event timestamp semantics. | Replayed client writes can return stable `duplicate` result without inflating aggregates. | Codex | Accepted |
| 2026-02-20 | DEC-0008 | Team/Challenge Boundaries | Added Sprint-2 Team + Challenge core schema (`backend/sql/004_sprint2_team_challenge_core.sql`) and baseline endpoints (`POST /teams`, `GET /teams/:id`, `POST /teams/:id/members`, `GET /challenges`, `POST /challenge-participants`). | Open Sprint 2 with role-aware team operations and challenge participation/progress while preserving Sprint 1 KPI contracts. | Establishes first-class team/challenge data boundaries and API surface with acceptance coverage for scenarios #7, #8, and E6. | Codex | Accepted |
| 2026-02-20 | DEC-0009 | Ops Validation | Added read-only ops summary endpoints (`GET /ops/summary/sprint1`, `GET /ops/summary/sprint2`) and `npm run ops:summary` workflow. | Provide no-UI validation path so sprint outcomes can be inspected through aggregate integrity metrics before full interface delivery. | Enables fast trust-but-verify checks for Sprint 1 and Sprint 2 without mutating application state. | Codex | Accepted |
| 2026-02-20 | DEC-0010 | Communication Boundaries | Added Sprint-3 communication core schema (`backend/sql/005_sprint3_communication_core.sql`) and baseline endpoints for channels/messages/unread/broadcast/push token registration. | Open Phase 3 baseline with server-side membership and broadcast policy enforcement while preserving prior sprint behavior. | Establishes communication module foundation and regression-backed acceptance path before UI integration. | Codex | Accepted |
| 2026-02-20 | DEC-0011 | Ops Validation | Extended ops diagnostics with `GET /ops/summary/sprint3` and updated `npm run ops:summary` to print Sprint 1-3 summaries. | Keep no-UI verification symmetric across completed sprints and reduce manual query friction. | Sprint health can now be reviewed from one command across KPI core, Team/Challenge, and Communication baselines. | Codex | Accepted |
| 2026-02-20 | DEC-0012 | Coaching + AI Boundaries | Added Sprint-4 coaching schema (`journeys`, `milestones`, `lessons`, `lesson_progress`, `coach_broadcasts`) and AI approval queue schema (`ai_suggestions`) with baseline APIs and admin-gated status transitions. | Deliver coaching/AI baseline while enforcing approval-first AI workflow and preserving KPI non-negotiables. | Establishes auditable coaching progress + scoped coaching broadcasts and prevents direct AI mutation/sending of KPI source-of-truth flows. | Codex | Accepted |
| 2026-02-20 | DEC-0013 | Launch Hardening | Added Sprint-5 release gate (`npm run test:release`, `test:sprint5`) and tightened coaching/AI access controls for team-scoped journey visibility and cross-user AI suggestion targeting. | Enforce launch-readiness with a single regression command and close high-risk permission gaps before rollout. | Release checklist now has executable gate criteria; coaching and AI endpoints enforce least-privilege scope rules with regression coverage. | Codex | Accepted |
| 2026-02-20 | DEC-0014 | Sponsored + Offline Baseline | Added Sprint-6 sponsored challenge schema (`sponsors`, `sponsored_challenges`), public sponsored challenge read APIs, and batched KPI ingest endpoint (`POST /kpi-logs/batch`) reusing idempotent single-write semantics. | Complete remaining member-facing backend MVP surfaces while preserving backward compatibility and non-negotiable KPI logic. | Enables tier-gated sponsored challenge flows and offline-safe batched log ingestion without breaking Sprint 1-5 contracts. | Codex | Accepted |
| 2026-02-20 | DEC-0015 | Admin Core Operations Baseline | Added Sprint-7 admin API baseline for KPI catalog, challenge templates, and user role/tier/status operations with platform-admin access enforcement and `admin_activity_log` auditing. | Close backend operations gap needed for platform management while keeping safe/deactivation-first mutation patterns. | Backend now supports minimum admin control plane for catalog/template/user governance with regression-backed access controls. | Codex | Accepted |
| 2026-02-20 | DEC-0016 | Notification Queue + Error Envelope Baseline | Added Sprint-8 notification queue schema (`notification_queue`), admin queue/dispatch APIs, and standardized error envelope usage for new queue routes. | Establish backend dispatch lifecycle foundation and improve operational error traceability without breaking legacy route behavior. | Adds auditable send/fail attempt tracking and stable machine-readable error fields (`code`, `message`, `request_id`) on Sprint-8 endpoints. | Codex | Accepted |
| 2026-02-20 | DEC-0017 | Confidence Snapshot + Policy Summary Baseline | Added Sprint-9 confidence snapshot schema (`forecast_confidence_snapshots`), confidence snapshot compute endpoint, and admin-only policy summary diagnostics endpoint. | Close confidence parity and security-observability gaps while preserving non-negotiable rule that confidence is display-only. | Confidence metadata is now persisted/auditable without mutating KPI base values; admin policy checks can be reviewed through one endpoint. | Codex | Accepted |
| 2026-02-20 | DEC-0018 | Backend MVP Finalization Gate | Added Sprint-10 performance index migration, `test:sprint10`, and consolidated `test:backend-mvp` command as the backend MVP release gate. | Finalize backend completion track with deterministic acceptance chain and query-path hardening before UI-heavy phase. | Backend now has a single explicit MVP gate that verifies Sprint 1-10 compatibility and final baseline readiness. | Codex | Accepted |
| 2026-02-20 | DEC-0019 | Design Exports | Defined frontend asset batch V1: versioned screen and component-sheet targets, export runbook (`design/figma/exports/EXPORT_BATCH_V1.md`), and updated FIGMA_INDEX + FIGMA_BUILD_MAPPING. Figma MCP does not provide downloadable asset URLs in this environment; exports are manual or via Figma API. | Align repo with single-source export naming and traceability; document why programmatic pull was not possible. | Clear target filenames and node-id capture process; all assets pending manual export. | — | Accepted |
| 2026-02-21 | DEC-0020 | Delivery Governance | Transitioned sprint gate from backend-only Sprint 10 completion to frontend kickoff FE-00, defining parallel frontend roadmap tracks (Mobile M1-M8 and Admin A1-A4), traceability matrix, and asset-readiness gate criteria in `architecture/CURRENT_SPRINT.md`; added frontend acceptance harness mapping in `docs/spec/05_acceptance_tests.md`. | Backend MVP gate was completed on 2026-02-20; frontend execution required an explicit scope/gate reset with decision-complete sprint sequencing and acceptance mapping. | Enables controlled frontend delivery with explicit sprint boundaries, dependency handling, and UI/API acceptance coverage tied to existing spec contracts. | Codex | Accepted |
| 2026-02-21 | DEC-0021 | Design Inventory + Export Automation | Used Figma REST API with PAT auth to generate frame inventory artifacts (`design/figma/FRAME_INVENTORY.md`, `design/figma/FRAME_INVENTORY.csv`) and exported FE-00 required screen assets directly into versioned targets under `design/figma/exports/screens/` with node-id + dimensions backfilled in design mapping docs. | Reduce manual frame hunting risk across 70+ Figma frames and unblock FE-00 asset gate progress with deterministic node-id based exports. | FE-00 required screen exports are now present; readiness moved from red to amber pending component-sheet exports. | Codex | Accepted |
| 2026-02-21 | DEC-0022 | Design Asset Normalization | Added automated SVG batch analyzer (`design/figma/scripts/analyze-svg-batch.mjs`) and generated deduped canonical SVG library (`design/figma/exports/components/svg_library_v1`) plus manifest outputs under `design/figma/exports/raw_svg_batch_v1/_analysis`. | Raw Figma SVG dumps contain inconsistent naming and high duplication; normalization is required before reliable component-sheet assembly and future automation. | Provides repeatable rename/dedupe workflow and traceable source-to-canonical mapping while preserving original raw batch. | Codex | Accepted |
| 2026-02-21 | DEC-0023 | FE-00 Component Sheet Assembly | Generated FE-00 required component-sheet PNG exports (`core_buttons_v1`, `core_inputs_v1`, `core_tabs_chips_v1`, `core_cards_v1`, `core_icons_v1`) from Figma node-image exports with source node manifest `design/figma/exports/components/core_component_sheets_manifest_v1.json`. | FE-00 gate requires five component sheets; raw assets existed but needed deterministic assembly and canonical output filenames. | FE-00 asset gate moved to green for M1/M2 readiness while keeping additional component sheets (nav/chart/badges) pending for later sprints. | Codex | Accepted |
| 2026-02-21 | DEC-0021 | Design Tooling | Added Figma REST API script `design/figma/scripts/list-frames.mjs` to list all frames (name + node id) from the Compass KPI file; README, `.env.example` for `FIGMA_TOKEN`, and FIGMA_INDEX section for programmatic frame inventory. | Figma MCP does not return file structure in this environment; REST API with personal access token provides frame list for export traceability and node-id backfill. | Enables programmatic frame inventory without manual copy-link; PNG export remains manual or via other Figma API endpoints. | — | Accepted |
| 2026-02-21 | DEC-0024 | Frontend UI Foundation | Added shared mobile UI tokens at `app/theme/tokens.ts` and refactored auth screens to consume one typography/spacing/color scale with capped dynamic text multiplier for layout stability. | FE-00/M1 auth parity requires consistent type behavior across screens and deterministic button visibility on common iPhone viewport classes. | Reduces font-size drift, prevents bottom CTA cutoff on larger system text settings, and creates a reusable style baseline for M2+ screens. | Codex | Accepted |
| 2026-02-21 | DEC-0025 | KPI Selection Boundary | Clarified KPI selection contract across product and API docs: onboarding/KPI-management selection surfaces must recommend 3-5 starter KPIs, allow full catalog visibility, exclude operational `Deal Closed`/`Pipeline_Anchor` entries from add/remove selection, and keep tier-restricted selectable KPIs visible in locked state. | Figma onboarding layouts under-specify KPI eligibility/visibility behavior and allowed `Deal Closed` to be interpreted as selectable KPI, creating product-rule drift. | Aligns implementation and QA on selectable-vs-operational KPI boundaries while preserving tier upsell visibility and non-negotiable PC/Actual separation. | Codex | Accepted |
| 2026-02-21 | DEC-0026 | KPI Value Governance | Clarified member-facing KPI value mutability boundaries: system KPI payout/value/weight metadata is read-only in onboarding/KPI-management UX and mutable only via platform-admin KPI catalog routes; custom KPI value-weight behavior remains out-of-scope pending explicit follow-up design/contract decision. | Figma onboarding variants implied editable KPI value fields, conflicting with centralized KPI governance and consistent forecast math requirements. | Prevents per-user KPI value drift, keeps forecast inputs admin-governed, and isolates Custom KPI value-weight expansion as a separate tracked decision. | Codex | Accepted |
| 2026-02-21 | DEC-0027 | Profile Write-Through API | Added authenticated `PATCH /me` route for member profile/goal updates; route writes profile metadata and immediately synchronizes calculation-critical financial inputs (`average_price_point`, `commission_rate_percent`) into `public.users` for backend KPI math. | M2 required profile persistence UX, and metadata-only updates could drift from backend projection inputs used by KPI calculation engine. | Profile edits now apply immediately to subsequent KPI calculations and remain traceable through API contract + frontend profile flow. | Codex | Accepted |
| 2026-02-21 | DEC-0028 | Algorithm Engine Boundary | Introduced dedicated deterministic backend engine modules for PC timeline/decay, confidence scoring, GP/VP tier+bump logic, and onboarding back-plot simulation (`backend/src/engines/*`), and moved dashboard chart-series generation to backend (`GET /dashboard.chart`). | Core product value depends on formula parity from Master Spec; frontend-derived projection math created drift and rework risk. | Dashboard/UI now consume backend-computed series and confidence components; algorithm constants are centralized and testable via `npm run test:algorithms`. | Codex | Accepted |
| 2026-02-21 | DEC-0029 | PC Timing Schema + Engine Parity | Added explicit TTC timing support with `ttc_definition`, `delay_days`, and `hold_days` on KPI definitions plus applied timing snapshots on KPI logs (`payoff_start_date`, `delay_days_applied`, `hold_days_applied`, `decay_days_applied`); backend now resolves timeline timing via dedicated parser/resolver and uses persisted timing in dashboard/confidence computations. | Master Spec requires TTC range parsing (`X-Y days`) so projected payoff starts later and holds before decay; legacy `ttc_days` alone could not represent delayed payoff windows accurately. | Enables accurate long-lag KPI projection behavior (for example calls paying off months later), preserves backward compatibility, and prevents historical timing drift when KPI definitions change later. | Codex | Accepted |
| 2026-02-21 | DEC-0030 | Onboarding Projection Initialization | `PATCH /me` now accepts onboarding KPI averages/targets and pipeline counts, and triggers a one-time onboarding seed that writes weekly synthetic historical PC logs (idempotent) plus initial pipeline anchor status. Dashboard projection now includes short-horizon pipeline influence for initial projection context while confidence still treats pipeline as dedicated input. | Master Spec onboarding flow requires backend processing of historical averages and current pipeline at account creation to produce an initial projection baseline. | New users receive immediate projection baseline without waiting for manual daily logs; seed remains one-time and non-duplicating on profile edits. | Codex | Accepted |
| 2026-02-21 | DEC-0031 | Adaptive PC Weighting + Admin Calibration Controls | Added Sprint-12 schema and engine hardening for per-user PC multipliers (`user_kpi_calibration`, `user_kpi_calibration_events`, applied weight snapshots on `kpi_logs`), integrated onboarding multiplier initialization, deal-close calibration updates, dashboard calibration diagnostics, and admin calibration management routes (inspect/manual set/reset/reinitialize/events). | Global-only KPI weights introduced observability bias and projection fairness drift; super admin needs explicit controls while calibration converges to user-specific behavior. | Projection math now supports bounded per-user adaptation without rewriting timeline decay logic; admin operations can inspect and adjust multipliers with audit trail while preserving non-negotiables. | Codex | Accepted |
| 2026-02-21 | DEC-0032 | KPI Log Deletion Endpoint + UI Control | Added authenticated log deletion route `DELETE /kpi-logs/{id}` with ownership enforcement and pipeline-anchor status recalculation; dashboard now returns `recent_logs` with log IDs and mobile Log Activities includes remove controls for recent entries. | Users need to correct mistaken KPI entries; without per-entry delete, projection/actual aggregates and confidence inputs remain polluted until manual DB intervention. | Enables safe user-led data correction in-app while preserving non-negotiables and keeping anchor-derived forecast inputs consistent after deletions. | Codex | Accepted |
| 2026-02-21 | DEC-0033 | KPI Catalog Spec Hardening | Added Sprint-14 migration `backend/sql/015_sprint14_kpi_catalog_spec_hardening.sql` to enforce canonical KPI catalog metadata (stable `slug`, explicit GP/VP point fields, complete PC timing specs with TTC definition + delay/hold/decay) and updated backend KPI selection/calculation flows to resolve onboarding slug-based KPI identifiers to DB IDs. | KPI selection surfaces were using a partial catalog and onboarding metadata keys could not consistently map to DB KPI IDs, causing missing catalog entries and incomplete projection seeding. | Dashboard/loggable catalog now has full spec-ready KPI rows, GP/VP point generation is table-driven, and onboarding/backplot/calibration paths consume canonical KPI IDs deterministically. | Codex | Accepted |
| 2026-02-21 | DEC-0034 | Legacy KPI Alias Removal (`Listings Taken`) | Added migration `backend/sql/016_sprint15_remove_legacy_listings_taken.sql` to remove the legacy duplicate KPI alias `Listings Taken`, delete logs tied to that legacy KPI, clean dependent calibration/anchor rows, and remap challenge KPI references to canonical `Listing Taken` where needed. | Legacy seed naming drift created duplicate KPI identities (`Listing Taken` vs `Listings Taken`) and inconsistent log attribution. | Restores single canonical KPI identity for listing capture, removes polluted legacy logs, and prevents duplicate KPI selection/render behavior. | Codex | Accepted |
| 2026-02-21 | DEC-0035 | Dashboard API Summary Metrics | Expanded `GET /dashboard` summary fields to expose UI-ready yearly rollups: `projection.pc_next_365`, `projection.projected_gci_ytd`, `actuals.actual_gci_last_365`, and `actuals.actual_gci_ytd`; mobile dashboard cards now render dual metrics with large scrollable values. | Dashboard cards needed two-number summaries (365-day and YTD) without frontend estimation drift; backend already had canonical log/event context for deterministic computation. | Keeps summary card math server-owned, reduces UI inference errors, and supports larger-value display patterns without changing existing endpoint compatibility. | Codex | Accepted |
| 2026-02-22 | DEC-0036 | Frontend Asset Intake Folder | Added `app/assets/figma/kpi_icon_bank/` as the canonical temporary intake folder for KPI icon-bank files used in mobile KPI grid/dashboard icon assignment work. | KPI icon assignment needs a stable drop location for exported/cropped assets before final icon-bank governance and admin customization surfaces are implemented. | Enables fast swap/review of KPI icons without changing UI layout code; future icon-bank replacement can keep the same app asset boundary. | Codex | Accepted |
| 2026-02-22 | DEC-0037 | Mobile Asset Pipeline | Added Expo Metro SVG transformer support (`app/metro.config.js`, `app/svg.d.ts`, `react-native-svg-transformer`) so KPI grid/dashboard icons can use source SVG exports from `app/assets/figma/kpi_icon_bank/` instead of cropped composite images. | Production UI asset handling should use source exports (SVG/PNG) for fidelity and maintainability; new KPI icon bank was delivered as named SVG files. | KPI tiles now render source SVGs with stable semantic mapping; future icon swaps can be done by file/map updates without layout changes. | Codex | Accepted |
| 2026-02-22 | DEC-0038 | KPI Catalog Canonical Source | Adopted canonical KPI catalog v2 files in spec appendix (`docs/spec/appendix/KPI_MASTER_CATALOG_CANONICAL.md`, `docs/spec/appendix/kpi_master_catalog.json`) and updated `Master Spec.md` Sections 5.1/5.3 to reference these files as the implementation source-of-truth for KPI membership/type assignment. | The in-document KPI examples and backend seed had begun diverging from the expanded KPI list and category assignments; a diffable human + machine source is required for parity governance. | Future backend seed/admin/app parity work should reconcile against canonical catalog files first, reducing ambiguity and drift across PC/GP/VP/operational KPI definitions. | Codex | Accepted |
| 2026-02-22 | DEC-0039 | KPI Catalog Canonical v2 DB Alignment Strategy | Added migration `backend/sql/017_sprint16_kpi_catalog_canonical_v2_alignment.sql` to align `public.kpis` with canonical v2 catalog, including `icon_file` metadata, missing KPI inserts, and safe preservation of historical semantics for three reclassified nurture KPIs (`Seasonal Check-In Call`, `Pop-By Delivered`, `Holiday Card Sent`) by renaming/deactivating legacy VP rows before inserting canonical PC rows. Added backend identifier aliases for legacy slugs (`coffee_lunch_sphere`, `good_night_sleep`). | Canonical v2 expands the KPI catalog and changes category assignment for several existing KPIs; direct type mutation would reinterpret historical logs. | Aligns database catalog with canonical source while preserving legacy KPI history, unlocks icon metadata storage, and keeps older onboarding/profile slug references resolvable during transition. | Codex | Accepted |
| 2026-02-23 | DEC-0040 | Frontend Motion Pipeline (M3b) | Added `lottie-react-native` to the Expo app and introduced reusable `app/components/LottieSlot.tsx` as the animation-slot boundary for dashboard GP/VP visual modules, with emoji fallback when no Lottie JSON is provided. | M3b dashboard gamification needs motion-ready UI sockets now while final animation assets are still being produced externally (for example Blender/AE/Lottie workflows). | Frontend can integrate Lottie animations incrementally without refactoring dashboard layout; GP/VP placeholders are now drop-in animation targets. | Codex | Accepted |
| 2026-02-23 | DEC-0041 | Sprint Governance (M3b Scope Exception Checklist) | Added `docs/spec/appendix/M3B_ANIMATION_AUDIO_CHECKLIST.md` as the execution checklist for time-boxed `M3b Dashboard Gamification + Interaction Polish`, including animation, haptics, and audio items mapped to Master Spec references; updated `architecture/CURRENT_SPRINT.md` traceability to include `M3b`. | Dashboard gameplay feel is the highest-value surface but sits between roadmap-defined `M3` foundation and `M7` polish. A scoped, traceable exception is needed to avoid ambiguous polish creep while preserving roadmap discipline. | Provides a locked, auditable M3b task boundary and acceptance checklist, including explicit split between code-only items and external asset/tool dependencies. | Codex | Accepted |
| 2026-02-25 | DEC-0042 | Algorithm / Forecast Integrity Planning | Integrated algorithm addendum planning docs for Projection Integrity & Calibration Hardening (Part 1) and Projection Lab admin simulation/regression harness (Part 2) into repo canon as spec-only, implementation-deferred updates; adopted planned forecast provenance separation (`real`, `seeded_history`, `provider_forecast`), continuity projection as provider-only forecast source (not persisted user logs), onboarding baseline/target data stream separation, and A3/A4 placement for Projection Lab with backend hooks allowed earlier by separate approval. | Uploaded addendum introduced algorithm and admin-harness behavior beyond current FE-00/M3b implementation focus; traceable spec integration and boundary decisions were required before parallel execution can proceed safely. | Canon docs now record accepted planned direction without changing active sprint implementation scope; future backend/admin implementation must update API contracts and acceptance coverage before build. | Codex | Accepted |
| 2026-02-25 | DEC-0043 | Challenge Participation API | Added self-leave route `DELETE /challenge-participants/{challengeId}` within the existing challenge-participants endpoint family and wired mobile Challenge details CTA support for join/leave state transitions with refresh-on-success. | Challenge mobile flow added real join action first, but users could not reverse accidental joins without manual DB intervention. A leave action is required to keep participation flows testable and user-correctable. | Challenge participation becomes reversible in-app without introducing a new endpoint family; mobile can refresh `GET /challenges` and preserve detail context after join/leave actions. | Codex | Accepted |
| 2026-02-26 | DEC-0044 | Coaching API Boundary | Added additive `packaging_read_model` response fields within existing coaching/channel/sponsored-challenge endpoint families (`GET /api/channels`, `GET /api/channels/{id}/messages`, `GET /api/coaching/journeys`, `GET /api/coaching/journeys/{id}`, `GET /sponsored-challenges`, `GET /sponsored-challenges/{id}`) plus thread-level channel context on `GET /api/channels/{id}/messages`. | M6 coaching package visibility/entitlement UI work needs consistent runtime packaging metadata and display requirements, but introducing net-new endpoint families/schema changes was out of scope for the approved in-family implementation pass. | Enables backend-owned packaging/entitlement read-model shaping as additive fields for coaching runtime UI consumption while preserving existing endpoint families and leaving deeper entitlement normalization/schema work for later approved slices. | Codex | Accepted |
| 2026-02-26 | DEC-0045 | AI Suggestion API Boundary | Added additive W5 AI queue/read-model response shaping within existing AI suggestion endpoint family (`POST /api/ai/suggestions`, `GET /api/ai/suggestions`, `POST /api/ai/suggestions/{id}/approve`, `POST /api/ai/suggestions/{id}/reject`) via `ai_queue_read_model` on suggestion payloads and list-level `queue_summary`, inferred from current `ai_suggestions` columns only. | W5 AI approval-first UI shell and coach/admin moderation planning requires runtime-consumable queue/approval/audit metadata, but a net-new AI queue endpoint family or schema changes were not approved for this in-family pass. | Enables additive approval-first queue/read-model outputs for W5 UI and ops surfaces while preserving existing endpoint family/authz semantics and deferring richer audit linkage/context persistence to later approved decision-gated work. | Codex | Accepted |
